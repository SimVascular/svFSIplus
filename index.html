<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>svFSIplus: svFSI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">svFSIplus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">svFSI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md50">Solver Parameter Input XML File</a></li>
<li class="level1"><a href="#autotoc_md51">Pre-built svFSIplus Binaries</a></li>
<li class="level1"><a href="#autotoc_md52">Building svFSIplus from Source</a><ul><li class="level2"><a href="#autotoc_md53">Build Process</a></li>
<li class="level2"><a href="#autotoc_md54">Required Software Packages</a><ul><li class="level3"><a href="#autotoc_md55">CMake</a></li>
<li class="level3"><a href="#autotoc_md56">Visualization Toolkit</a></li>
<li class="level3"><a href="#autotoc_md57">Open MPI</a></li>
</ul>
</li>
<li class="level2"><a href="#autotoc_md58">Using Trilinos with svFSIplus</a><ul><li class="level3"><a href="#autotoc_md59">Building Trilinos</a></li>
<li class="level3"><a href="#autotoc_md60">Compiling with Trilinos Libraries</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md61">Running a Simulation</a></li>
</ul>
</div>
<div class="textblock"><p>The following sections describe how to build and use svFSIplus. Implementation details can be found <a class="el" href="implementation.html">here</a>. See the <a class="el" href="testing.html">testing guide</a> for instructions on running the provided examples.</p>
<h1><a class="anchor" id="autotoc_md50"></a>
Solver Parameter Input XML File</h1>
<p>The svFSI solver reads simulation parameters from a <a href="https://github.com/SimVascular/svFSI/blob/master/svFSI_master.inp">custom text format</a> file. <a class="el" href="class_simulation.html">Simulation</a> parameters are set using keyword/value pairs separated by a colon. A keyword consists of series of alphanumeric characters separated by spaces.</p>
<p>Keyword/value example </p><div class="fragment"><div class="line">Coupled: 1</div>
<div class="line">Min iterations: 1</div>
<div class="line">Tolerance: 1e-6</div>
</div><!-- fragment --><p>Braces **{}** are used to define simulation parameters with sub-elements. For example the <code>Domain</code> keyword is associated with several other sub-elements of keyword/values pairs. </p><div class="fragment"><div class="line">Domain: 0 {</div>
<div class="line">  Equation: fluid</div>
<div class="line">  Density: 1.0</div>
<div class="line">  Viscosity: Constant {Value: 0.04}</div>
<div class="line">  Backflow stabilization coefficient: 0.2</div>
<div class="line">}</div>
</div><!-- fragment --><p>svFSIplus solver simulation parameters are stored in an XML-format file. The XML file organization and keyword names replicate the original text format using the following conversion rules</p><ul>
<li>Spaces in keywords names are replaced by underscores</li>
<li>An additional value after a colon is replaced by an XML attribute used to identify the value. For example: <code>Add equation: FSI</code> is replaced by <code>&lt;Add_equation type="FSI" &gt;</code>.</li>
<li><a class="el" href="class_parameters.html" title="The Parameters class stores parameter values read in from a solver input file.">Parameters</a> with sub-elements are replaced by an XML element with sub-elements. For example <code>Add equation: FSI { sub-elements }</code> is replaced by <code>&lt;Add_equation type="FSI" &gt; xml-sub-elements &lt;/Add_equation&gt;</code>.</li>
</ul>
<p>Example: The original text </p><div class="fragment"><div class="line">Add equation: FSI {</div>
<div class="line">   Coupled: 1</div>
<div class="line">   Min iterations: 1</div>
<div class="line">   Max iterations: 10</div>
<div class="line">   Tolerance: 1e-6</div>
<div class="line"> </div>
<div class="line">   Domain: 0 {</div>
<div class="line">      Equation: fluid</div>
<div class="line">      Density: 1.0</div>
<div class="line">      Viscosity: Constant {Value: 0.04}</div>
<div class="line">      Backflow stabilization coefficient: 0.2</div>
<div class="line">   }</div>
<div class="line">}</div>
</div><!-- fragment --><p> is replaced by new XML format with </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">Add_equation</span> <span class="keyword">type</span>=<span class="stringliteral">&quot;FSI&quot;</span> &gt;</div>
<div class="line">   &lt;<span class="keywordtype">Coupled</span>&gt; <span class="keyword">true</span> &lt;/<span class="keywordtype">Coupled</span>&gt;</div>
<div class="line">   &lt;<span class="keywordtype">Min_iterations</span>&gt; 1 &lt;/<span class="keywordtype">Min_iterations</span>&gt;</div>
<div class="line">   &lt;<span class="keywordtype">Max_iterations</span>&gt; 10 &lt;/<span class="keywordtype">Max_iterations</span>&gt;</div>
<div class="line">   &lt;<span class="keywordtype">Tolerance</span>&gt; 1<span class="keyword">e-6</span> &lt;/<span class="keywordtype">Tolerance</span>&gt;</div>
<div class="line"> </div>
<div class="line">   &lt;<span class="keywordtype">Domain</span> <span class="keyword">id</span>=<span class="stringliteral">&quot;0&quot;</span> &gt;</div>
<div class="line">      &lt;<span class="keywordtype">Equation</span>&gt; <span class="keyword">fluid</span> &lt;/<span class="keywordtype">Equation</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">Density</span>&gt; 1.0 &lt;/<span class="keywordtype">Density</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">Viscosity</span> <span class="keyword">model</span>=<span class="stringliteral">&quot;Constant&quot;</span> &gt;</div>
<div class="line">         &lt;<span class="keywordtype">Value</span>&gt; 0.04 &lt;/<span class="keywordtype">Value</span>&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">Viscosity</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">Backflow_stabilization_coefficient</span>&gt; 0.2 &lt;/<span class="keywordtype">Backflow_stabilization_coefficient</span>&gt;</div>
<div class="line">   &lt;/<span class="keywordtype">Domain</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">Add_equation</span>&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md51"></a>
Pre-built svFSIplus Binaries</h1>
<p>Pre-built svFSIplus binaries can be downloaded from the <a href="https://simtk.org/frs/?group_id=188">SimVascular SimTK downloads page</a>. Installers are provided for MacOS and Ubuntu operating systems.</p>
<p>The compilers and other software used to build the binaries (listed on the downloads page) must be installed on the target platform in order to use the svFSIplus binary.</p>
<h1><a class="anchor" id="autotoc_md52"></a>
Building svFSIplus from Source</h1>
<p>The svFSIplus source code can be downloaded and built on computers running MacOS and other Linux operating systems. Builds are most commonly done on MacOS and Ubuntu platforms.</p>
<p><b>The Windows operating system is currently not supported.</b></p>
<h2><a class="anchor" id="autotoc_md53"></a>
Build Process</h2>
<p>Several <a href="#building_packages">software packages</a> must be installed in order to build and use svFSIplus.</p>
<p>svFSIplus is built on a MacOS or Linux computer from a terminal using the following commands </p><div class="fragment"><div class="line">mkdir svFSIplus-package</div>
<div class="line">cd svFSIplus-package</div>
<div class="line">git clone https://github.com/SimVascular/svFSIplus</div>
<div class="line">mkdir build</div>
<div class="line">cd build/</div>
<div class="line">cmake ../svFSIplus/</div>
<div class="line">make -j4</div>
</div><!-- fragment --><p>This creates the svFSIplus binary <code>svFSIplus-package/build/svFSI-build/bin/svFSIplus*</code>.</p>
<p>The binary can be installed in /usr/local using the following commands</p><ul>
<li>cd svFSI-build</li>
<li>sudo make install</li>
</ul>
<p>The <code>svFSIplus*</code> binary is now located in /usr/local/SV/bin.</p>
<p>It is convenient to update the PATH environment variable with the location of the <code>svFSIplus*</code> binary. Another option is to create an alias for <code>svFSIplus</code>. For example: <code>alias svFsiPlus=/usr/local/SV/bin/svFSIplus</code></p>
<h2><a class="anchor" id="autotoc_md54"></a>
Required Software Packages</h2>
<p>The following software packages are required to build svFSIplus</p>
<ul>
<li>CMake</li>
<li>C++17 compiler</li>
<li>Visualization Toolkit</li>
<li>Open MPI</li>
</ul>
<p>Software packages can be installed using package management tools like <a href="https://brew.sh">homebrew</a> and <a href="https://en.wikipedia.org/wiki/APT_(software)">apt</a>.</p>
<h3><a class="anchor" id="autotoc_md55"></a>
CMake</h3>
<p>svFSIplus is built using <a href="https://cmake.org">CMake</a>. CMake is used to control the software compilation process using the <code>CMakeLists.txt</code> files located within the svFSIplus source. CMake first attempts to discover the software dependencies (e.g. C++ compiler) required to build svFSIplus. It will then generate the native <a href="https://en.wikipedia.org/wiki/Make_(software)">makefiles</a> used to compile it.</p>
<h3><a class="anchor" id="autotoc_md56"></a>
Visualization Toolkit</h3>
<p>svFSIplus uses the <a href="https://vtk.org/">The Visualization Toolkit (VTK)</a> to read finite element mesh data stored in VTP and VTU <a href="https://kitware.github.io/vtk-examples/site/VTKFileFormats/">formats</a>. The <a href="https://vtk.org/doc/nightly/html/classvtkPolyData.html#details">VTP</a> format is used to store 2D finite element meshes for inlet and outlet surfaces. The <a href="https://vtk.org/doc/nightly/html/classvtkUnstructuredGrid.html#details">VTU</a> format is used to store finite element volume meshes. svFSIplus can also write simulation results to VTK format files.</p>
<h3><a class="anchor" id="autotoc_md57"></a>
Open MPI</h3>
<p>svFSIplus uses the <a href="https://www.open-mpi.org/">Open MPI</a> Message Passing Interface (MPI) libraries for parallel computing.</p>
<h2><a class="anchor" id="autotoc_md58"></a>
Using Trilinos with svFSIplus</h2>
<p>By default svFSIplus uses custom linear algebra solvers (e.g. GMRES) in a simulation. It also supports several simple preconditioners.</p>
<p>svFSIplus can also be built with the linear algebra solvers and preconditioners provided by the <a href="https://trilinos.github.io/">Trilinos</a> scientific software package. Using <a class="el" href="struct_trilinos.html" title="Initialize all Epetra types we need separate from Fortran.">Trilinos</a> can often reduce the execution time of a simulation.</p>
<h3><a class="anchor" id="autotoc_md59"></a>
Building Trilinos</h3>
<p>The <a class="el" href="struct_trilinos.html" title="Initialize all Epetra types we need separate from Fortran.">Trilinos</a> libraries need to be built from the source downloaded from <a href="https://github.com/trilinos/Trilinos">here</a>. See the <a href="https://github.com/trilinos/Trilinos/blob/master/INSTALL.rst">Quick configure, build and install hints for Trilinos</a> for the instructions about how to build <a class="el" href="struct_trilinos.html" title="Initialize all Epetra types we need separate from Fortran.">Trilinos</a>.</p>
<p>Build with the third-party libraries (TPLs)</p><ul>
<li>Boost</li>
<li>BLAS</li>
<li>HDF5</li>
<li>HYPRE</li>
<li>LAPACK</li>
<li>MUMPS</li>
</ul>
<p>and with The <a class="el" href="struct_trilinos.html" title="Initialize all Epetra types we need separate from Fortran.">Trilinos</a> packages <br  />
</p><ul>
<li>Amesos</li>
<li>AztecOO</li>
<li>Epetra</li>
<li>EpetraEXT</li>
<li>Ifpack</li>
<li>ML</li>
<li>MueLU</li>
<li>ROL</li>
<li>Sacado</li>
<li>Teuchos</li>
<li>Zoltan</li>
</ul>
<h3><a class="anchor" id="autotoc_md60"></a>
Compiling with Trilinos Libraries</h3>
<p>svFSIplus is compiled with the <a class="el" href="struct_trilinos.html" title="Initialize all Epetra types we need separate from Fortran.">Trilinos</a> libraries using the CMake <code>SV_USE_TRILINOS</code> option </p><div class="fragment"><div class="line">cmake ../svFSIplus/ -DSV_USE_TRILINOS:BOOL=ON </div>
</div><!-- fragment --><p> CMake will be able to find the <a class="el" href="struct_trilinos.html" title="Initialize all Epetra types we need separate from Fortran.">Trilinos</a> libraries once they have been built and installed.</p>
<h1><a class="anchor" id="autotoc_md61"></a>
Running a Simulation</h1>
<p>The svFSIplus binary is run from the command line with an input solver parameters XML file as an argument</p>
<div class="fragment"><div class="line">svFSIplus solver_params.xml</div>
</div><!-- fragment --><p>A simulation can be run in parallel on four processors using</p>
<div class="fragment"><div class="line">mpiexec -np 4 svFSIplus solver_params.xml</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
